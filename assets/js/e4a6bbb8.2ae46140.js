"use strict";(self.webpackChunksite=self.webpackChunksite||[]).push([[6867],{28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var i=r(96540);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},33893:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"tutorial-basics/Kroki","title":"Kroki","description":"Kroki provides a unified API for all the diagram libraries.","source":"@site/docs/tutorial-basics/Kroki.md","sourceDirName":"tutorial-basics","slug":"/tutorial-basics/Kroki","permalink":"/site/docs/tutorial-basics/Kroki","draft":false,"unlisted":false,"editUrl":"https://github.com/AdrianoRuseler/site/edit/main/docs/tutorial-basics/Kroki.md","tags":[],"version":"current","lastUpdatedBy":"Adriano Ruseler","lastUpdatedAt":1764679134000,"frontMatter":{"title":"Kroki","description":"Kroki provides a unified API for all the diagram libraries."},"sidebar":"tutorialSidebar","previous":{"title":"Deploy your site","permalink":"/site/docs/tutorial-basics/deploy-your-site"},"next":{"title":"Prism (Code Block)","permalink":"/site/docs/tutorial-basics/Prism"}}');var t=r(74848),s=r(28453);const o={title:"Kroki",description:"Kroki provides a unified API for all the diagram libraries."},a=void 0,l={},c=[{value:"MATLAB integration",id:"matlab-integration",level:2},{value:"Self hosted docker",id:"self-hosted-docker",level:2},{value:"CLI",id:"cli",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Integrating Kroki with Docusaurus",id:"integrating-kroki-with-docusaurus",level:2},{value:"Step 1: Install the Plugin",id:"step-1-install-the-plugin",level:3},{value:"Step 2: Configure Docusaurus",id:"step-2-configure-docusaurus",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"matlab-integration",children:"MATLAB integration"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/AdrianoRuseler/kroki-matlab",children:"https://github.com/AdrianoRuseler/kroki-matlab"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"self-hosted-docker",children:"Self hosted docker"}),"\n",(0,t.jsx)(n.p,{children:"docker-compose.yml"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yml",children:'name: kroki-api\r\nservices:\r\n  kroki:\r\n    image: yuzutech/kroki\r\n    depends_on:\r\n      - mermaid\r\n      - bpmn\r\n      - excalidraw\r\n    environment:\r\n      - KROKI_MERMAID_HOST=mermaid\r\n      - KROKI_BPMN_HOST=bpmn\r\n      - KROKI_EXCALIDRAW_HOST=excalidraw\r\n    ports:\r\n      - "8000:8000"\r\n    # If you do need to explicitly mount /tmp, make sure to include the exec option\r\n    tmpfs:\r\n      - /tmp:exec\r\n  mermaid:\r\n    image: yuzutech/kroki-mermaid\r\n    expose:\r\n      - "8002"\r\n  bpmn:\r\n    image: yuzutech/kroki-bpmn\r\n    expose:\r\n      - "8003"\r\n  excalidraw:\r\n    image: yuzutech/kroki-excalidraw\r\n    expose:\r\n      - "8004"\n'})}),"\n",(0,t.jsx)(n.h2,{id:"cli",children:"CLI"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://github.com/yuzutech/kroki-cli",children:"https://github.com/yuzutech/kroki-cli"})}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,t.jsx)(n.p,{children:"To configure the endpoint, you can use a configuration file.\r\nThe CLI will look for the following locations:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"/etc/kroki.yml"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"$HOME/kroki.yml"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"kroki.yml"})," same location as ",(0,t.jsx)(n.code,{children:"hello.dot"})]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["You can also specify an alternate config file using the ",(0,t.jsx)(n.code,{children:"--config"})," flag:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kroki convert hello.dot --config config.yml\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The config file should contain the endpoint URL and the HTTP timeout.\r\nBy default, Kroki will use the demonstration server: ",(0,t.jsx)(n.a,{href:"https://demo.kroki.io",children:"https://demo.kroki.io"})," and a timeout of 20 seconds."]}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"Please note that the demonstration server usage is restricted to reasonable, non-commercial use-cases.\r\nWe provide no guarantee regarding uptime or latency."})}),"\n",(0,t.jsx)(n.p,{children:"Example:"}),"\n",(0,t.jsx)(n.p,{children:"kroki.yml"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yml",children:'endpoint: "http://localhost:8000"\r\ntimeout: 30s\n'})}),"\n",(0,t.jsx)(n.p,{children:"If you don't want to use a file you can also use the following environment variables:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"KROKI_ENDPOINT"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"KROKI_TIMEOUT"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Set the Environment Variables"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"set KROKI_ENDPOINT=http://localhost:8000\r\nset KROKI_TIMEOUT=15s\n"})}),"\n",(0,t.jsx)(n.p,{children:"Execute the Command"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kroki convert hello.dot\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"kroki convert hello.dot -o out.png\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: text/plain" --data-binary "@hello.dot" http://localhost:8000/graphviz/svg\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: text/plain" --data-binary "@directional-angles.tex" http://localhost:8000/tikz/svg > teste.svg\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: text/plain" --data-binary "@directional-angles.tex" https://kroki.io/tikz/svg > teste2.svg\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: text/plain" --data-binary "@directional-angles.tex" https://demo.kroki.io/tikz/svg > teste3.svg\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Saves the output to diagram.svg\r\ncurl -X POST -H "Content-Type: text/plain" --data-binary "@hello.dot" http://localhost:8000/graphviz/svg > diagram.svg\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://di-mgt.com.au/base64-for-windows.html",children:"https://di-mgt.com.au/base64-for-windows.html"})}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# Saves the output to diagram.svg\r\ncurl -X POST -H "Content-Type: text/plain" --data-binary "@hello.dot" http://localhost:8000/graphviz/svg > diagram.svg\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'curl -X POST -H "Content-Type: text/plain" --data-binary "@hello.dot" http://localhost:8000/graphviz/svg | base64 > diagram_base64.txt\n'})}),"\n",(0,t.jsx)(n.h2,{id:"integrating-kroki-with-docusaurus",children:"Integrating Kroki with Docusaurus"}),"\n",(0,t.jsx)(n.p,{children:"Integrating Kroki with Docusaurus is an excellent way to embed a wide range of diagrams (Mermaid, PlantUML, BlockDiag, etc.) directly into your documentation, treating them like native Markdown code blocks."}),"\n",(0,t.jsx)(n.p,{children:"Since Docusaurus uses MDX (which is based on Remark), the most robust way to achieve this is by using a Remark plugin. The recommended plugin for this is remark-kroki (or similar community-maintained plugins like remark-kroki-diagrams-plugin)."}),"\n",(0,t.jsx)(n.p,{children:"Here is a step-by-step guide on how to set it up:"}),"\n",(0,t.jsx)(n.h3,{id:"step-1-install-the-plugin",children:"Step 1: Install the Plugin"}),"\n",(0,t.jsx)(n.p,{children:"First, install the remark-kroki package in your Docusaurus project directory:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Install Kroki's remark plugin\r\nnpm install --save-dev remark-kroki\r\n\r\n# If you haven't already set up Docusaurus for TypeScript\r\n# npm install --save-dev typescript @docusaurus/module-type-aliases @docusaurus/tsconfig @docusaurus/types\n"})}),"\n",(0,t.jsx)(n.h3,{id:"step-2-configure-docusaurus",children:"Step 2: Configure Docusaurus"}),"\n",(0,t.jsx)(n.p,{children:"You need to tell Docusaurus to use this plugin when processing Markdown files. Edit your docusaurus.config.js file."}),"\n",(0,t.jsx)(n.p,{children:"You must import the plugin and then add it to the remarkPlugins array within the configuration for your content plugin (usually the docs or classic preset)."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'// docusaurus.config.js\r\n\r\n// 1. Import the plugin dynamically since it\'s an ES Module\r\nconst { remarkKroki } = await import("remark-kroki");\r\n\r\nmodule.exports = {\r\n  presets: [\r\n    [\r\n      "classic",\r\n      {\r\n        docs: {\r\n          // 2. Add the plugin to your docs configuration\r\n          remarkPlugins: [\r\n            [\r\n              remarkKroki,\r\n              {\r\n                // REQUIRED: Set the Kroki server URL\r\n                server: "http://localhost:8000",\r\n                // OR use the public service: server: \'https://kroki.io\',\r\n\r\n                // OPTIONAL: Specify how to embed the SVG\r\n                // \'img-base64\' is a common default\r\n                output: "img-base64",\r\n\r\n                // OPTIONAL: Set aliases so you can use ```plantuml``` instead of ```kroki type=plantuml```\r\n                // alias: ["plantuml", "mermaid", "graphviz", "wireviz"],\r\n              },\r\n            ],\r\n          ],\r\n          // ... other docs options\r\n        },\r\n        // ... other preset options\r\n      },\r\n    ],\r\n  ],\r\n  // ... rest of your config\r\n};\n'})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);